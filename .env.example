# =============================================================================
# Sistema de Nómina - Variables de Entorno
# =============================================================================
# Copiar este archivo a .env y configurar los valores apropiados.
# IMPORTANTE: Los valores marcados con [CAMBIAR EN PRODUCCIÓN] DEBEN ser
# modificados antes de desplegar en un entorno de producción.
# =============================================================================

# -----------------------------------------------------------------------------
# Base de Datos PostgreSQL
# -----------------------------------------------------------------------------
DB_USER=nomina
DB_PASSWORD=nomina123                    # [CAMBIAR EN PRODUCCIÓN]
DB_NAME=nomina_db

# -----------------------------------------------------------------------------
# Redis (Colas de procesamiento asíncrono)
# -----------------------------------------------------------------------------
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=                          # [CAMBIAR EN PRODUCCIÓN] Dejar vacío para dev
REDIS_DB=0

# -----------------------------------------------------------------------------
# Autenticación JWT
# -----------------------------------------------------------------------------
# Clave secreta para firmar tokens JWT
# IMPORTANTE: Generar una clave única y segura en producción (mínimo 32 caracteres)
# Ejemplo: openssl rand -base64 32
JWT_SECRET=tu-clave-secreta-super-segura-cambiar-en-produccion    # [CAMBIAR EN PRODUCCIÓN]
JWT_EXPIRES_IN=24h

# -----------------------------------------------------------------------------
# Cifrado de Datos Sensibles
# -----------------------------------------------------------------------------
# Clave para cifrar datos sensibles (RFC, CURP, información bancaria)
# IMPORTANTE: Generar una clave única y segura en producción (mínimo 32 caracteres)
# Ejemplo: openssl rand -base64 32
ENCRYPTION_KEY=generate-secure-key-min-32-chars    # [CAMBIAR EN PRODUCCIÓN]

# -----------------------------------------------------------------------------
# Storage de Evidencias Fiscales
# -----------------------------------------------------------------------------
# Ruta donde se almacenan los documentos fiscales (XML, PDF, acuses)
# En Docker, usar: /app/storage/fiscal
FISCAL_STORAGE_PATH=/app/storage/fiscal

# -----------------------------------------------------------------------------
# Frontend URL (CORS)
# -----------------------------------------------------------------------------
# URL del frontend para configuración de CORS
# Desarrollo: http://localhost:5173
# Producción: https://tu-dominio.com
FRONTEND_URL=http://localhost

# -----------------------------------------------------------------------------
# PAC (Proveedor Autorizado de Certificación) - Timbrado CFDI
# -----------------------------------------------------------------------------
# URL del servicio del PAC
# Ejemplos:
#   Finkok Sandbox: https://demo-facturacion.finkok.com
#   Finkok Producción: https://facturacion.finkok.com
PAC_URL=https://demo-facturacion.finkok.com
PAC_USER=usuario_pac
PAC_PASSWORD=password_pac                # [CAMBIAR EN PRODUCCIÓN]

# -----------------------------------------------------------------------------
# Certificados de Sello Digital (CSD)
# -----------------------------------------------------------------------------
# Rutas a los archivos del certificado de sello digital
# Estos archivos deben montarse como volúmenes o copiarse al contenedor
CER_PATH=./certs/certificado.cer
KEY_PATH=./certs/llave.key
KEY_PASSWORD=password_certificado        # [CAMBIAR EN PRODUCCIÓN]

# -----------------------------------------------------------------------------
# Modo de Cola de Procesamiento
# -----------------------------------------------------------------------------
# api: Solo API (enqueue jobs, no procesa) - usar con workers separados
# worker: Solo Worker (procesa jobs, no API) - usado por el servicio worker
# both: API + Worker en mismo proceso (desarrollo o instancia única)
# sync: Modo síncrono sin Redis (desarrollo local sin Redis)
#
# Para producción con alto volumen:
#   - Backend: QUEUE_MODE=api
#   - Workers: Ejecutar node dist/worker.js (usa WorkerModule)
QUEUE_MODE=both

# -----------------------------------------------------------------------------
# Worker de Procesamiento (Enterprise)
# -----------------------------------------------------------------------------
# Número de trabajos concurrentes que puede procesar el worker
WORKER_CONCURRENCY=3

# =============================================================================
# PROVEEDORES DE IA (ChatBot)
# =============================================================================
# Configure al menos uno de los siguientes proveedores para habilitar el ChatBot IA.
# Puede configurar múltiples proveedores para tener fallback automático.

# -----------------------------------------------------------------------------
# Proveedor de IA por Defecto
# -----------------------------------------------------------------------------
# Opciones: anthropic, openai, gemini
# Si no se especifica, se usa el primer proveedor configurado en orden de prioridad:
# anthropic > openai > gemini
AI_PROVIDER=anthropic

# -----------------------------------------------------------------------------
# Anthropic Claude
# -----------------------------------------------------------------------------
# API Key de Anthropic (comienza con sk-ant-)
# Obtener en: https://console.anthropic.com/
# Costo: ~$5 USD iniciales (créditos)
ANTHROPIC_API_KEY=

# Modelo de Anthropic a usar
# Opciones (de menor a mayor costo):
#   - claude-3-haiku-20240307   (rápido, económico - RECOMENDADO)
#   - claude-3-sonnet-20240229  (equilibrado)
#   - claude-sonnet-4-20250514  (último Sonnet)
#   - claude-3-opus-20240229    (más capaz, costoso)
ANTHROPIC_MODEL=claude-3-haiku-20240307

# -----------------------------------------------------------------------------
# OpenAI GPT
# -----------------------------------------------------------------------------
# API Key de OpenAI (comienza con sk-)
# Obtener en: https://platform.openai.com/api-keys
# Costo: Pay-as-you-go
OPENAI_API_KEY=

# Modelo de OpenAI a usar
# Opciones (de menor a mayor costo):
#   - gpt-4o-mini     (rápido, económico - RECOMENDADO)
#   - gpt-4o          (equilibrado)
#   - gpt-4-turbo     (rápido, capaz)
#   - gpt-4           (original)
OPENAI_MODEL=gpt-4o-mini

# -----------------------------------------------------------------------------
# Google Gemini
# -----------------------------------------------------------------------------
# API Key de Google AI (comienza con AIza)
# Obtener en: https://aistudio.google.com/app/apikey
# Costo: Tier gratuito generoso (1,500 peticiones/día)
GOOGLE_AI_API_KEY=

# Modelo de Gemini a usar
# Opciones (de menor a mayor costo):
#   - gemini-1.5-flash  (rápido, económico - RECOMENDADO)
#   - gemini-1.5-pro    (equilibrado)
#   - gemini-1.0-pro    (estable)
GEMINI_MODEL=gemini-1.5-flash

# -----------------------------------------------------------------------------
# n8n (Automatización y Workflows)
# -----------------------------------------------------------------------------
N8N_BASE_URL=http://n8n:5678
N8N_WEBHOOK_BASE_URL=http://n8n:5678/webhook
N8N_API_KEY=
N8N_USER=admin
N8N_PASSWORD=admin123                          # [CAMBIAR EN PRODUCCIÓN]
N8N_HOST=localhost
N8N_PORT=5678

# -----------------------------------------------------------------------------
# WhatsApp (Twilio)
# -----------------------------------------------------------------------------
# Credenciales de Twilio para WhatsApp Business
# Obtener en: https://console.twilio.com/
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_WHATSAPP_NUMBER=                        # Formato: whatsapp:+5215551234567
WHATSAPP_VERIFY_TOKEN=nomina_verify_token

# -----------------------------------------------------------------------------
# Email (SMTP)
# -----------------------------------------------------------------------------
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=                                 # [CAMBIAR EN PRODUCCIÓN]
SMTP_FROM_EMAIL=noreply@empresa.com
SMTP_FROM_NAME=Sistema de Nomina

# -----------------------------------------------------------------------------
# Microsoft Azure AD (SSO/OAuth)
# -----------------------------------------------------------------------------
# Configuración opcional para autenticación con Microsoft
AZURE_AD_CLIENT_ID=
AZURE_AD_TENANT_ID=
AZURE_AD_CLIENT_SECRET=

# -----------------------------------------------------------------------------
# Configuración Adicional
# -----------------------------------------------------------------------------
NODE_ENV=development
PORT=3000
ENABLE_SWAGGER=true
GENERIC_TIMEZONE=America/Mexico_City
PAC_MODE=sandbox                               # sandbox | production | disabled
MFA_ENABLED=false
AUTH_PROVIDER=local                            # local | microsoft | combined
